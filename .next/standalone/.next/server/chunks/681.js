exports.id=681,exports.ids=[681],exports.modules={98020:(e,a,d)=>{let t={"067060037a75f005439918d9fa246b510679bcf1":()=>Promise.resolve().then(d.bind(d,45247)).then(e=>e.$$ACTION_2),"0aa2753f4c5c9e267bdfe41bb6dfd75e8d2cbff6":()=>Promise.resolve().then(d.bind(d,45247)).then(e=>e.createListing),"58ed5bbaa85d255292baf8aba25c4a07c7e80a40":()=>Promise.resolve().then(d.bind(d,45247)).then(e=>e.getListingById),"64fd960cfd7af4d30707bdefd94da62903576a93":()=>Promise.resolve().then(d.bind(d,45247)).then(e=>e.getOwnedListingById),a44eac80d9a1a0040b970ea25de7a8d85fcc50a4:()=>Promise.resolve().then(d.bind(d,45247)).then(e=>e.getListings),bb5a5113cf8622f83e03f856ce80b496e8dd5e47:()=>Promise.resolve().then(d.bind(d,45247)).then(e=>e.$$ACTION_0),bd12bcafed4fce27c9e0d8b6a1be9463e7e7f752:()=>Promise.resolve().then(d.bind(d,45247)).then(e=>e.$$ACTION_1),c16e9b0ffa6a408dad2f5997cf326ae06b44b4d1:()=>Promise.resolve().then(d.bind(d,45247)).then(e=>e.$$ACTION_3),d36b29d06e37f5131001fbebc6e7a104ae8d2507:()=>Promise.resolve().then(d.bind(d,45247)).then(e=>e.$$ACTION_4),f71d8aca32bb00c035910ca7953e75596f736162:()=>Promise.resolve().then(d.bind(d,45247)).then(e=>e.updateListing),"0b0257361201c67ca7edfd2944301935df9b21f2":()=>Promise.resolve().then(d.bind(d,8392)).then(e=>e.$$ACTION_1),b676ec8e1485e7c1a29ec33d480771117f6799e4:()=>Promise.resolve().then(d.bind(d,8392)).then(e=>e.$$ACTION_0),cac5bff2370d361859fcb45ded3a18f9feb290ff:()=>Promise.resolve().then(d.bind(d,8392)).then(e=>e.getProperties),db16f98a7dd509dc43fd9fb70035dab959baf639:()=>Promise.resolve().then(d.bind(d,8392)).then(e=>e.deleteProperty),d43d4493005236cb5219abd8b6f97fe8c9759f39:()=>Promise.resolve().then(d.bind(d,78914)).then(e=>e.registerUser),ee7d38f2e7324f031e7ed2193792af0e219aaca2:()=>Promise.resolve().then(d.bind(d,78914)).then(e=>e.$$ACTION_0)};async function r(e,...a){return(await t[e]()).apply(null,a)}e.exports={"067060037a75f005439918d9fa246b510679bcf1":r.bind(null,"067060037a75f005439918d9fa246b510679bcf1"),"0aa2753f4c5c9e267bdfe41bb6dfd75e8d2cbff6":r.bind(null,"0aa2753f4c5c9e267bdfe41bb6dfd75e8d2cbff6"),"58ed5bbaa85d255292baf8aba25c4a07c7e80a40":r.bind(null,"58ed5bbaa85d255292baf8aba25c4a07c7e80a40"),"64fd960cfd7af4d30707bdefd94da62903576a93":r.bind(null,"64fd960cfd7af4d30707bdefd94da62903576a93"),a44eac80d9a1a0040b970ea25de7a8d85fcc50a4:r.bind(null,"a44eac80d9a1a0040b970ea25de7a8d85fcc50a4"),bb5a5113cf8622f83e03f856ce80b496e8dd5e47:r.bind(null,"bb5a5113cf8622f83e03f856ce80b496e8dd5e47"),bd12bcafed4fce27c9e0d8b6a1be9463e7e7f752:r.bind(null,"bd12bcafed4fce27c9e0d8b6a1be9463e7e7f752"),c16e9b0ffa6a408dad2f5997cf326ae06b44b4d1:r.bind(null,"c16e9b0ffa6a408dad2f5997cf326ae06b44b4d1"),d36b29d06e37f5131001fbebc6e7a104ae8d2507:r.bind(null,"d36b29d06e37f5131001fbebc6e7a104ae8d2507"),f71d8aca32bb00c035910ca7953e75596f736162:r.bind(null,"f71d8aca32bb00c035910ca7953e75596f736162"),"0b0257361201c67ca7edfd2944301935df9b21f2":r.bind(null,"0b0257361201c67ca7edfd2944301935df9b21f2"),b676ec8e1485e7c1a29ec33d480771117f6799e4:r.bind(null,"b676ec8e1485e7c1a29ec33d480771117f6799e4"),cac5bff2370d361859fcb45ded3a18f9feb290ff:r.bind(null,"cac5bff2370d361859fcb45ded3a18f9feb290ff"),db16f98a7dd509dc43fd9fb70035dab959baf639:r.bind(null,"db16f98a7dd509dc43fd9fb70035dab959baf639"),d43d4493005236cb5219abd8b6f97fe8c9759f39:r.bind(null,"d43d4493005236cb5219abd8b6f97fe8c9759f39"),ee7d38f2e7324f031e7ed2193792af0e219aaca2:r.bind(null,"ee7d38f2e7324f031e7ed2193792af0e219aaca2")}},88829:(e,a,d)=>{let t={"0ad09d62211ecf130a12e0b1fb6dd072ad373b1e":()=>Promise.resolve().then(d.bind(d,88658)).then(e=>e.$$ACTION_3),"1106a624fc89780734d43596a1878891b0872f57":()=>Promise.resolve().then(d.bind(d,88658)).then(e=>e.getReservations),"2ad9c02f7138be20aaff203fa989dbdd2c65d88f":()=>Promise.resolve().then(d.bind(d,88658)).then(e=>e.deleteReservation),"31b04723e7c53cd1acbec67b730e7d0abc16a5f7":()=>Promise.resolve().then(d.bind(d,88658)).then(e=>e.$$ACTION_0),"33f115557067f48ceee4a50b443aa423758b731d":()=>Promise.resolve().then(d.bind(d,88658)).then(e=>e.$$ACTION_1),"3e9103be237aebf085f90f3c7858dad7d4c215ad":()=>Promise.resolve().then(d.bind(d,88658)).then(e=>e.$$ACTION_2),"578785c17f7947cb2d65472cb4242c57c8621203":()=>Promise.resolve().then(d.bind(d,88658)).then(e=>e.createPaymentSession),"84b639be183e082fba4d06c9dff2f39883927b92":()=>Promise.resolve().then(d.bind(d,88658)).then(e=>e.createReservation),"001837c49f82a4a4d75b3dc0964dc6c76e2d2b77":()=>Promise.resolve().then(d.bind(d,41183)).then(e=>e.getFavoriteListings),"476c2e271afa7809c316ac65717a0cf700a3d3d8":()=>Promise.resolve().then(d.bind(d,41183)).then(e=>e.$$ACTION_1),"573aee30d49bf9c1a8aea2c43b09b3a41110c6c2":()=>Promise.resolve().then(d.bind(d,41183)).then(e=>e.$$ACTION_0),ab224d6a6aaea9fdd9ddb9b9a8c9dad0cd2e02f8:()=>Promise.resolve().then(d.bind(d,41183)).then(e=>e.updateFavorite),c1a53f0f37ee773167b45a3bf6a61b76eb07c326:()=>Promise.resolve().then(d.bind(d,41183)).then(e=>e.getFavorites),db2f0e26ed6c20fadfc94ebc5160fc769b450ad9:()=>Promise.resolve().then(d.bind(d,41183)).then(e=>e.$$ACTION_2)};async function r(e,...a){return(await t[e]()).apply(null,a)}e.exports={"0ad09d62211ecf130a12e0b1fb6dd072ad373b1e":r.bind(null,"0ad09d62211ecf130a12e0b1fb6dd072ad373b1e"),"1106a624fc89780734d43596a1878891b0872f57":r.bind(null,"1106a624fc89780734d43596a1878891b0872f57"),"2ad9c02f7138be20aaff203fa989dbdd2c65d88f":r.bind(null,"2ad9c02f7138be20aaff203fa989dbdd2c65d88f"),"31b04723e7c53cd1acbec67b730e7d0abc16a5f7":r.bind(null,"31b04723e7c53cd1acbec67b730e7d0abc16a5f7"),"33f115557067f48ceee4a50b443aa423758b731d":r.bind(null,"33f115557067f48ceee4a50b443aa423758b731d"),"3e9103be237aebf085f90f3c7858dad7d4c215ad":r.bind(null,"3e9103be237aebf085f90f3c7858dad7d4c215ad"),"578785c17f7947cb2d65472cb4242c57c8621203":r.bind(null,"578785c17f7947cb2d65472cb4242c57c8621203"),"84b639be183e082fba4d06c9dff2f39883927b92":r.bind(null,"84b639be183e082fba4d06c9dff2f39883927b92"),"001837c49f82a4a4d75b3dc0964dc6c76e2d2b77":r.bind(null,"001837c49f82a4a4d75b3dc0964dc6c76e2d2b77"),"476c2e271afa7809c316ac65717a0cf700a3d3d8":r.bind(null,"476c2e271afa7809c316ac65717a0cf700a3d3d8"),"573aee30d49bf9c1a8aea2c43b09b3a41110c6c2":r.bind(null,"573aee30d49bf9c1a8aea2c43b09b3a41110c6c2"),ab224d6a6aaea9fdd9ddb9b9a8c9dad0cd2e02f8:r.bind(null,"ab224d6a6aaea9fdd9ddb9b9a8c9dad0cd2e02f8"),c1a53f0f37ee773167b45a3bf6a61b76eb07c326:r.bind(null,"c1a53f0f37ee773167b45a3bf6a61b76eb07c326"),db2f0e26ed6c20fadfc94ebc5160fc769b450ad9:r.bind(null,"db2f0e26ed6c20fadfc94ebc5160fc769b450ad9")}},50103:(e,a,d)=>{Promise.resolve().then(d.bind(d,49589)),Promise.resolve().then(d.bind(d,8825)),Promise.resolve().then(d.bind(d,54655)),Promise.resolve().then(d.bind(d,75675))},75675:(e,a,d)=>{"use strict";d.d(a,{default:()=>s});var t=d(10326),r=d(17577),i=d.n(r),n=d(94093),c=d(6162),f=d(54655);let b=(e,a,d,t)=>{let i=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let r=new IntersectionObserver(r=>{r[0].isIntersecting&&!d&&a&&!t&&e()},{root:null,rootMargin:"240px",threshold:.1});return i.current&&r.observe(i.current),()=>r.disconnect()},[a,t,d,e]),{ref:i}},s=({nextCursor:e,fnArgs:a,queryFn:d,queryKey:r,favorites:s})=>{let l=(0,c.T)("Errors"),{data:o,isFetchingNextPage:u,hasNextPage:h,status:g,fetchNextPage:v}=(0,n.N)({queryFn:({pageParam:t=e})=>d({...a,cursor:t}),queryKey:r,getNextPageParam:e=>e?.nextCursor}),{ref:m}=b(v,h,"loading"===g||u,"error"===g);return(0,t.jsxs)(t.Fragment,{children:[o?.pages.map((e,a)=>t.jsx(i().Fragment,{children:e?.listings?.map(e=>{let a=s.includes(e.id);return t.jsx(f.default,{data:e,hasFavorited:a,reservation:e?.reservation},e?.reservation?.id||e.id)})},a)),("loading"===g||u)&&t.jsx(t.Fragment,{children:Array.from({length:4}).map((e,a)=>t.jsx(f.T,{},a))}),"error"===g&&t.jsx("p",{className:"text-xl mt-8 text-center font-semibold",children:l("somethingWentWrong")}),t.jsx("div",{ref:m})]})}},14984:(e,a,d)=>{"use strict";d.d(a,{Z:()=>i});var t=d(19510);d(71159);let r=(0,d(68570).createProxy)(String.raw`/home/oussasz/Project/Dz Dari/lugario/components/BackButton.tsx#default`),i=({title:e,subtitle:a,center:d,backBtn:i=!1})=>(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:d?"text-center":"text-start",children:[t.jsx("h3",{className:"text-2xl font-bold leading-[1.25]",children:e}),t.jsx("p",{className:"font-light text-neutral-500 md:mt-1 mt-2",children:a})]}),i?t.jsx(r,{}):null]})},16757:(e,a,d)=>{"use strict";d.d(a,{Z:()=>t});let t=(0,d(68570).createProxy)(String.raw`/home/oussasz/Project/Dz Dari/lugario/components/LoadMore.tsx#default`)},69206:(e,a,d)=>{"use strict";d.d(a,{A:()=>i});var t=d(82604);let r=process.env.STRIPE_API_KEY,i=r?new t.Z(r,{apiVersion:"2024-09-30.acacia",typescript:!0}):null},45247:(e,a,d)=>{"use strict";d.r(a),d.d(a,{$$ACTION_0:()=>s,$$ACTION_1:()=>o,$$ACTION_2:()=>h,$$ACTION_3:()=>v,$$ACTION_4:()=>y,createListing:()=>u,getListingById:()=>l,getListings:()=>b,getOwnedListingById:()=>g,updateListing:()=>m});var t=d(27745);d(26461);var r=d(88296),i=d(30207),n=d(33408),c=d(10692),f=d(85723);let b=(0,t.j)("bb5a5113cf8622f83e03f856ce80b496e8dd5e47",s);async function s(e){try{let{userId:a,roomCount:d,guestCount:t,bathroomCount:i,country:c,region:f,municipality:b,startDate:s,endDate:l,category:o,duration:u,feature:h,cursor:g}=e||{},v={};if(a&&(v.userId=a),o){let e=Array.isArray(o)?o:[o];v.category={in:e}}if(u){let e=Array.isArray(u)?u:[u];v.duration={in:e}}if(h){let e=Array.isArray(h)?h:[h];v.AND=[...v.AND??[],...e.map(e=>({features:{contains:e}}))]}d&&(v.roomCount={gte:+d}),t&&(v.guestCount={gte:+t}),i&&(v.bathroomCount={gte:+i}),c&&(v.country=c),f&&(v.region=f),b&&(v.municipality=b),s&&l&&(v.NOT={reservations:{some:{OR:[{endDate:{gte:s},startDate:{lte:s}},{startDate:{lte:l},endDate:{gte:l}}]}}});let m={where:v,take:n.UM,orderBy:{createdAt:"desc"}};g&&(m.cursor={id:g},m.skip=1);let y=await r.db.listing.findMany(m),p=y.length===n.UM?y[n.UM-1].id:null;return{listings:y,nextCursor:p}}catch(e){return{listings:[],nextCursor:null}}}let l=(0,t.j)("bd12bcafed4fce27c9e0d8b6a1be9463e7e7f752",o);async function o(e){return await r.db.listing.findUnique({where:{id:e},include:{user:{select:{name:!0,image:!0}},reservations:{select:{startDate:!0,endDate:!0}}}})}let u=(0,t.j)("067060037a75f005439918d9fa246b510679bcf1",h);async function h(e){let{category:a,duration:d,features:t,location:{region:i,label:n,latlng:f},municipality:b,address:s,guestCount:l,bathroomCount:o,roomCount:u,image:h,price:g,title:v,description:m}=e;for(let a of["category","duration","location","municipality","address","guestCount","roomCount","bathroomCount","image","price","title","description"])if(!e[a])throw Error(`Missing required field: ${a}`);let y=await (0,c.t)();if(!y)throw Error("Unauthorized!");return await r.db.listing.create({data:{title:v,description:m,imageSrc:h,category:a,duration:d,features:Array.isArray(t)?t.join(","):t||"",roomCount:u,bathroomCount:o,guestCount:l,country:n,region:i,municipality:b,address:s,latitude:f[0],longitude:f[1],price:parseInt(g,10),userId:y.id}})}let g=(0,t.j)("c16e9b0ffa6a408dad2f5997cf326ae06b44b4d1",v);async function v(e){if(!e||"string"!=typeof e)throw Error("Invalid ID");let a=await (0,c.t)();if(!a)throw Error("Unauthorized!");let d=await r.db.listing.findUnique({where:{id:e,userId:a.id}});if(!d)throw Error("Listing not found!");return d}let m=(0,t.j)("d36b29d06e37f5131001fbebc6e7a104ae8d2507",y);async function y(e,a){if(!e||"string"!=typeof e)throw Error("Invalid ID");let d=await (0,c.t)();if(!d)throw Error("Unauthorized!");let{category:t,duration:n,features:f,location:b,municipality:s,address:l,guestCount:o,bathroomCount:u,roomCount:h,image:g,price:v,title:m,description:y}=a;for(let e of["category","duration","location","municipality","address","guestCount","roomCount","bathroomCount","image","price","title","description"])if(!a[e])throw Error(`Missing required field: ${e}`);let p=b?.region,P=b?.label,I=b?.latlng;if(!p||!P||!Array.isArray(I)||I.length<2)throw Error("Invalid location");if(!(await r.db.listing.updateMany({where:{id:e,userId:d.id},data:{title:m,description:y,imageSrc:g,category:t,duration:n,features:Array.isArray(f)?f.join(","):f||"",roomCount:h,bathroomCount:u,guestCount:o,country:P,region:p,municipality:s,address:l,latitude:I[0],longitude:I[1],price:parseInt(v,10)}})).count)throw Error("Listing not found!");return(0,i.revalidatePath)("/"),(0,i.revalidatePath)("/properties"),(0,i.revalidatePath)("/favorites"),(0,i.revalidatePath)(`/listings/${e}`),{id:e}}(0,f.h)([b,l,u,g,m]),(0,t.j)("a44eac80d9a1a0040b970ea25de7a8d85fcc50a4",b),(0,t.j)("58ed5bbaa85d255292baf8aba25c4a07c7e80a40",l),(0,t.j)("0aa2753f4c5c9e267bdfe41bb6dfd75e8d2cbff6",u),(0,t.j)("64fd960cfd7af4d30707bdefd94da62903576a93",g),(0,t.j)("f71d8aca32bb00c035910ca7953e75596f736162",m)},8392:(e,a,d)=>{"use strict";d.r(a),d.d(a,{$$ACTION_0:()=>s,$$ACTION_1:()=>o,deleteProperty:()=>l,getProperties:()=>b});var t=d(27745);d(26461);var r=d(88296),i=d(33408),n=d(10692),c=d(30207),f=d(85723);let b=(0,t.j)("b676ec8e1485e7c1a29ec33d480771117f6799e4",s);async function s(e){try{let{userId:a,cursor:d}=e||{};if(!a)throw Error("Unauthorized");let t={where:{userId:a},take:i.UM,orderBy:{createdAt:"desc"}};d&&(t.cursor={id:d},t.skip=1);let n=await r.db.listing.findMany({...t}),c=n.length===i.UM?n[i.UM-1].id:null;return{listings:n,nextCursor:c}}catch(e){return{listings:[],nextCursor:null}}}let l=(0,t.j)("0b0257361201c67ca7edfd2944301935df9b21f2",o);async function o(e){try{let a=await (0,n.t)();if(!a)throw Error("Unauthorized");if(!e||"string"!=typeof e)throw Error("Invalid ID");return await r.db.listing.deleteMany({where:{id:e,userId:a.id}}),(0,c.revalidatePath)("/"),(0,c.revalidatePath)("/reservation"),(0,c.revalidatePath)("/trips"),(0,c.revalidatePath)("/favorites"),(0,c.revalidatePath)("/properties"),(0,c.revalidatePath)(`/listings/${e}`),"success"}catch(e){throw Error("Failed to delete the property!")}}(0,f.h)([b,l]),(0,t.j)("cac5bff2370d361859fcb45ded3a18f9feb290ff",b),(0,t.j)("db16f98a7dd509dc43fd9fb70035dab959baf639",l)},88658:(e,a,d)=>{"use strict";d.r(a),d.d(a,{$$ACTION_0:()=>l,$$ACTION_1:()=>u,$$ACTION_2:()=>g,$$ACTION_3:()=>m,createPaymentSession:()=>v,createReservation:()=>o,deleteReservation:()=>h,getReservations:()=>s});var t=d(24330);d(60166);var r=d(57708),i=d(9487),n=d(67738),c=d(84848),f=d(69206),b=d(40618);let s=(0,t.j)("31b04723e7c53cd1acbec67b730e7d0abc16a5f7",l);async function l(e){try{let{listingId:a,userId:d,authorId:t,cursor:r}=e,c={};d&&(c.userId=d),a&&(c.listingId=a),t&&(c.listing={userId:t});let f={where:c,take:n.UM,include:{listing:!0},orderBy:{createdAt:"desc"}};r&&(f.cursor={id:r},f.skip=1);let b=await i.db.reservation.findMany({...f}),s=b.length===n.UM?b[n.UM-1].id:null;return{listings:b.map(e=>{let{id:a,startDate:d,endDate:t,totalPrice:r,listing:i}=e;return{...i,reservation:{id:a,startDate:d,endDate:t,totalPrice:r}}}),nextCursor:s}}catch(e){return console.log(e?.message),{listings:[],nextCursor:null}}}let o=(0,t.j)("33f115557067f48ceee4a50b443aa423758b731d",u);async function u({listingId:e,startDate:a,endDate:d,totalPrice:t,userId:n}){try{if(!e||!a||!d||!t)throw Error("Invalid data");await i.db.listing.update({where:{id:e},data:{reservations:{create:{userId:n,startDate:a,endDate:d,totalPrice:t}}}}),(0,r.revalidatePath)(`/listings/${e}`)}catch(e){throw Error(e?.message)}}let h=(0,t.j)("3e9103be237aebf085f90f3c7858dad7d4c215ad",g);async function g(e){try{let a=await (0,c.t)();if(!a)throw Error("Unauthorized");if(!e||"string"!=typeof e)throw Error("Invalid ID");let d=await i.db.reservation.findUnique({where:{id:e}});if(!d)throw Error("Reservation not found!");return await i.db.reservation.deleteMany({where:{id:e,OR:[{userId:a.id},{listing:{userId:a.id}}]}}),(0,r.revalidatePath)("/reservations"),(0,r.revalidatePath)(`/listings/${d.listingId}`),(0,r.revalidatePath)("/trips"),d}catch(e){throw Error(e.message)}}let v=(0,t.j)("0ad09d62211ecf130a12e0b1fb6dd072ad373b1e",m);async function m({listingId:e,startDate:a,endDate:d,totalPrice:t}){if(!e||!a||!d||!t)throw Error("Invalid data");let r=await i.db.listing.findUnique({where:{id:e}});if(!r)throw Error("Listing not found!");let n=await (0,c.t)();if(!n)throw Error("Please log in to reserve!");let b=await f.A.products.create({name:"Listing",images:[r.imageSrc],default_price_data:{currency:"USD",unit_amount:100*t}});return{url:(await f.A.checkout.sessions.create({success_url:`${process.env.NEXT_PUBLIC_SERVER_URL}/trips`,cancel_url:`${process.env.NEXT_PUBLIC_SERVER_URL}/listings/${r.id}`,payment_method_types:["card"],mode:"payment",shipping_address_collection:{allowed_countries:["DE","US","NP","CH","BH","AU"]},metadata:{listingId:e,startDate:String(a),endDate:String(d),totalPrice:t,userId:n.id},line_items:[{price:b.default_price,quantity:1}]})).url}}(0,b.h)([s,o,h,v]),(0,t.j)("1106a624fc89780734d43596a1878891b0872f57",s),(0,t.j)("84b639be183e082fba4d06c9dff2f39883927b92",o),(0,t.j)("2ad9c02f7138be20aaff203fa989dbdd2c65d88f",h),(0,t.j)("578785c17f7947cb2d65472cb4242c57c8621203",v)},67738:(e,a,d)=>{"use strict";d.d(a,{UM:()=>i});var t=d(63759),r=d(43758);t.Paj,t.f$3,t.sHf,t.dKE,t.Yfi,t.KfF,t.Nzl,t.eAf,t.Yqy,t.jsv,t.I4E,t.rhR,t.vc9,r.Q7H,t.Ys1,t.IB_,t.bVG,t.yEz,t.XG1,t.eVG,t.WKE,t.h9I,t.fC4;let i=16}};