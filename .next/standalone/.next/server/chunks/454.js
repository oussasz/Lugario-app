exports.id=454,exports.ids=[454],exports.modules={51596:(e,a,t)=>{let r={"067060037a75f005439918d9fa246b510679bcf1":()=>Promise.resolve().then(t.bind(t,22818)).then(e=>e.$$ACTION_2),"0aa2753f4c5c9e267bdfe41bb6dfd75e8d2cbff6":()=>Promise.resolve().then(t.bind(t,22818)).then(e=>e.createListing),"58ed5bbaa85d255292baf8aba25c4a07c7e80a40":()=>Promise.resolve().then(t.bind(t,22818)).then(e=>e.getListingById),"64fd960cfd7af4d30707bdefd94da62903576a93":()=>Promise.resolve().then(t.bind(t,22818)).then(e=>e.getOwnedListingById),a44eac80d9a1a0040b970ea25de7a8d85fcc50a4:()=>Promise.resolve().then(t.bind(t,22818)).then(e=>e.getListings),bb5a5113cf8622f83e03f856ce80b496e8dd5e47:()=>Promise.resolve().then(t.bind(t,22818)).then(e=>e.$$ACTION_0),bd12bcafed4fce27c9e0d8b6a1be9463e7e7f752:()=>Promise.resolve().then(t.bind(t,22818)).then(e=>e.$$ACTION_1),c16e9b0ffa6a408dad2f5997cf326ae06b44b4d1:()=>Promise.resolve().then(t.bind(t,22818)).then(e=>e.$$ACTION_3),d36b29d06e37f5131001fbebc6e7a104ae8d2507:()=>Promise.resolve().then(t.bind(t,22818)).then(e=>e.$$ACTION_4),f71d8aca32bb00c035910ca7953e75596f736162:()=>Promise.resolve().then(t.bind(t,22818)).then(e=>e.updateListing),"001837c49f82a4a4d75b3dc0964dc6c76e2d2b77":()=>Promise.resolve().then(t.bind(t,41183)).then(e=>e.getFavoriteListings),"476c2e271afa7809c316ac65717a0cf700a3d3d8":()=>Promise.resolve().then(t.bind(t,41183)).then(e=>e.$$ACTION_1),"573aee30d49bf9c1a8aea2c43b09b3a41110c6c2":()=>Promise.resolve().then(t.bind(t,41183)).then(e=>e.$$ACTION_0),ab224d6a6aaea9fdd9ddb9b9a8c9dad0cd2e02f8:()=>Promise.resolve().then(t.bind(t,41183)).then(e=>e.updateFavorite),c1a53f0f37ee773167b45a3bf6a61b76eb07c326:()=>Promise.resolve().then(t.bind(t,41183)).then(e=>e.getFavorites),db2f0e26ed6c20fadfc94ebc5160fc769b450ad9:()=>Promise.resolve().then(t.bind(t,41183)).then(e=>e.$$ACTION_2)};async function d(e,...a){return(await r[e]()).apply(null,a)}e.exports={"067060037a75f005439918d9fa246b510679bcf1":d.bind(null,"067060037a75f005439918d9fa246b510679bcf1"),"0aa2753f4c5c9e267bdfe41bb6dfd75e8d2cbff6":d.bind(null,"0aa2753f4c5c9e267bdfe41bb6dfd75e8d2cbff6"),"58ed5bbaa85d255292baf8aba25c4a07c7e80a40":d.bind(null,"58ed5bbaa85d255292baf8aba25c4a07c7e80a40"),"64fd960cfd7af4d30707bdefd94da62903576a93":d.bind(null,"64fd960cfd7af4d30707bdefd94da62903576a93"),a44eac80d9a1a0040b970ea25de7a8d85fcc50a4:d.bind(null,"a44eac80d9a1a0040b970ea25de7a8d85fcc50a4"),bb5a5113cf8622f83e03f856ce80b496e8dd5e47:d.bind(null,"bb5a5113cf8622f83e03f856ce80b496e8dd5e47"),bd12bcafed4fce27c9e0d8b6a1be9463e7e7f752:d.bind(null,"bd12bcafed4fce27c9e0d8b6a1be9463e7e7f752"),c16e9b0ffa6a408dad2f5997cf326ae06b44b4d1:d.bind(null,"c16e9b0ffa6a408dad2f5997cf326ae06b44b4d1"),d36b29d06e37f5131001fbebc6e7a104ae8d2507:d.bind(null,"d36b29d06e37f5131001fbebc6e7a104ae8d2507"),f71d8aca32bb00c035910ca7953e75596f736162:d.bind(null,"f71d8aca32bb00c035910ca7953e75596f736162"),"001837c49f82a4a4d75b3dc0964dc6c76e2d2b77":d.bind(null,"001837c49f82a4a4d75b3dc0964dc6c76e2d2b77"),"476c2e271afa7809c316ac65717a0cf700a3d3d8":d.bind(null,"476c2e271afa7809c316ac65717a0cf700a3d3d8"),"573aee30d49bf9c1a8aea2c43b09b3a41110c6c2":d.bind(null,"573aee30d49bf9c1a8aea2c43b09b3a41110c6c2"),ab224d6a6aaea9fdd9ddb9b9a8c9dad0cd2e02f8:d.bind(null,"ab224d6a6aaea9fdd9ddb9b9a8c9dad0cd2e02f8"),c1a53f0f37ee773167b45a3bf6a61b76eb07c326:d.bind(null,"c1a53f0f37ee773167b45a3bf6a61b76eb07c326"),db2f0e26ed6c20fadfc94ebc5160fc769b450ad9:d.bind(null,"db2f0e26ed6c20fadfc94ebc5160fc769b450ad9")}},5741:(e,a,t)=>{let r={"0b0257361201c67ca7edfd2944301935df9b21f2":()=>Promise.resolve().then(t.bind(t,8392)).then(e=>e.$$ACTION_1),b676ec8e1485e7c1a29ec33d480771117f6799e4:()=>Promise.resolve().then(t.bind(t,8392)).then(e=>e.$$ACTION_0),cac5bff2370d361859fcb45ded3a18f9feb290ff:()=>Promise.resolve().then(t.bind(t,8392)).then(e=>e.getProperties),db16f98a7dd509dc43fd9fb70035dab959baf639:()=>Promise.resolve().then(t.bind(t,8392)).then(e=>e.deleteProperty),"0ad09d62211ecf130a12e0b1fb6dd072ad373b1e":()=>Promise.resolve().then(t.bind(t,51047)).then(e=>e.$$ACTION_3),"1106a624fc89780734d43596a1878891b0872f57":()=>Promise.resolve().then(t.bind(t,51047)).then(e=>e.getReservations),"2ad9c02f7138be20aaff203fa989dbdd2c65d88f":()=>Promise.resolve().then(t.bind(t,51047)).then(e=>e.deleteReservation),"31b04723e7c53cd1acbec67b730e7d0abc16a5f7":()=>Promise.resolve().then(t.bind(t,51047)).then(e=>e.$$ACTION_0),"33f115557067f48ceee4a50b443aa423758b731d":()=>Promise.resolve().then(t.bind(t,51047)).then(e=>e.$$ACTION_1),"3e9103be237aebf085f90f3c7858dad7d4c215ad":()=>Promise.resolve().then(t.bind(t,51047)).then(e=>e.$$ACTION_2),"578785c17f7947cb2d65472cb4242c57c8621203":()=>Promise.resolve().then(t.bind(t,51047)).then(e=>e.createPaymentSession),"84b639be183e082fba4d06c9dff2f39883927b92":()=>Promise.resolve().then(t.bind(t,51047)).then(e=>e.createReservation),d43d4493005236cb5219abd8b6f97fe8c9759f39:()=>Promise.resolve().then(t.bind(t,78914)).then(e=>e.registerUser),ee7d38f2e7324f031e7ed2193792af0e219aaca2:()=>Promise.resolve().then(t.bind(t,78914)).then(e=>e.$$ACTION_0)};async function d(e,...a){return(await r[e]()).apply(null,a)}e.exports={"0b0257361201c67ca7edfd2944301935df9b21f2":d.bind(null,"0b0257361201c67ca7edfd2944301935df9b21f2"),b676ec8e1485e7c1a29ec33d480771117f6799e4:d.bind(null,"b676ec8e1485e7c1a29ec33d480771117f6799e4"),cac5bff2370d361859fcb45ded3a18f9feb290ff:d.bind(null,"cac5bff2370d361859fcb45ded3a18f9feb290ff"),db16f98a7dd509dc43fd9fb70035dab959baf639:d.bind(null,"db16f98a7dd509dc43fd9fb70035dab959baf639"),"0ad09d62211ecf130a12e0b1fb6dd072ad373b1e":d.bind(null,"0ad09d62211ecf130a12e0b1fb6dd072ad373b1e"),"1106a624fc89780734d43596a1878891b0872f57":d.bind(null,"1106a624fc89780734d43596a1878891b0872f57"),"2ad9c02f7138be20aaff203fa989dbdd2c65d88f":d.bind(null,"2ad9c02f7138be20aaff203fa989dbdd2c65d88f"),"31b04723e7c53cd1acbec67b730e7d0abc16a5f7":d.bind(null,"31b04723e7c53cd1acbec67b730e7d0abc16a5f7"),"33f115557067f48ceee4a50b443aa423758b731d":d.bind(null,"33f115557067f48ceee4a50b443aa423758b731d"),"3e9103be237aebf085f90f3c7858dad7d4c215ad":d.bind(null,"3e9103be237aebf085f90f3c7858dad7d4c215ad"),"578785c17f7947cb2d65472cb4242c57c8621203":d.bind(null,"578785c17f7947cb2d65472cb4242c57c8621203"),"84b639be183e082fba4d06c9dff2f39883927b92":d.bind(null,"84b639be183e082fba4d06c9dff2f39883927b92"),d43d4493005236cb5219abd8b6f97fe8c9759f39:d.bind(null,"d43d4493005236cb5219abd8b6f97fe8c9759f39"),ee7d38f2e7324f031e7ed2193792af0e219aaca2:d.bind(null,"ee7d38f2e7324f031e7ed2193792af0e219aaca2")}},1667:(e,a,t)=>{"use strict";t.d(a,{default:()=>h});var r=t(10326),d=t(17577),n=t(35047),i=t(61006),l=t(40155),s=t(91594),c=t.n(s);t(63754);var o=t(6162),f=t(15491);let b=({icon:e,label:a,displayLabel:t,selected:d,queryKey:i="category"})=>{let l=(0,n.useRouter)(),s=(0,n.useSearchParams)();return(0,r.jsxs)("button",{type:"button",onClick:()=>{let e={};s&&(e=f.Z.parse(s.toString()));let t=e[i],r=Array.isArray(t)?t:"string"==typeof t?[t]:[],d=r.includes(a)?r.filter(e=>e!==a):[...r,a],n={...e,[i]:d.length?d:void 0};d.length||delete n[i];let c=f.Z.stringifyUrl({url:"/",query:n},{skipNull:!0});l.push(c)},className:`group flex flex-col max-w-fit items-center justify-center gap-2 p-2 border-b-2 transition-all duration-200 cursor-pointer text-[20px] md:text-[24px] hover:text-rose-500 ${d?"border-b-rose-500 text-rose-500":"border-transparent text-neutral-500"}`,children:[r.jsx("span",{className:"transition-all duration-200 ease-out group-hover:scale-[1.4] group-hover:text-rose-500",children:r.jsx(e,{})}),r.jsx("small",{className:"font-medium md:text-[13.75px] text-[12.75px] select-none",children:t??a})]})};var u=t(63347);let h=()=>{let e=(0,o.T)("Categories"),a=(0,o.T)("DurationOptions"),t=(0,o.T)("PurposeOptions"),s=(0,o.T)("FeatureOptions"),[f,h]=(0,d.useState)(!1),m=(0,n.useSearchParams)(),g=(0,n.usePathname)(),p=m?.getAll("category")??[],y=m?.getAll("duration")??[],x=m?.getAll("feature")??[],v=(0,d.useRef)(null),w=(0,d.useRef)(null),j=(0,d.useRef)(null),N=(0,d.useRef)(null),C=(0,d.useRef)(!1),P=(0,d.useCallback)(e=>{if(!e?.el||!e?.slides?.length)return;let a=e.el.getBoundingClientRect();e.slides.forEach(e=>{let t=e.firstElementChild;if(!t)return;let r=e.getBoundingClientRect(),d=r.left+r.width/2,n=Math.min(d-a.left,a.right-d);if(n<150){let e=n/150;t.style.opacity=String(e),t.style.transform=`scale(${e})`}else t.style.opacity="1",t.style.transform="scale(1)";t.style.transformOrigin="center",t.style.willChange="transform, opacity"})},[]),$=(0,d.useCallback)(e=>{null===v.current&&(v.current=window.requestAnimationFrame(()=>{v.current=null,P(e)}))},[P]),I=(0,d.useCallback)(e=>{let a=w.current;a&&(a.params.speed=e,a.autoplay?.running&&(a.autoplay.stop(),a.autoplay.start()))},[]),A=(0,d.useCallback)(()=>{C.current||(C.current=!0,I(2500))},[2500,I]),E=(0,d.useCallback)(()=>{C.current&&(C.current=!1,I(8e3))},[8e3,I]);return((0,d.useEffect)(()=>()=>{null!==v.current&&window.cancelAnimationFrame(v.current),null!==N.current&&window.cancelAnimationFrame(N.current)},[]),(0,d.useEffect)(()=>{let e=c()(()=>{window.scrollY>0?h(!0):h(!1)},150);return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),"/"!==g)?null:r.jsx("div",{className:` ${f?"shadow-md shadow-[rgba(0,0,0,.045)]":""} transition-all duration-150`,children:r.jsx("div",{ref:j,className:"relative overflow-hidden",onMouseMove:e=>{let a=window.innerWidth,t=e.clientX,r=a/3;t<r||t>a-r?A():E()},onMouseLeave:()=>E(),children:(0,r.jsxs)(i.tq,{slidesPerView:"auto",loop:!0,speed:8e3,autoplay:{delay:0,disableOnInteraction:!1,pauseOnMouseEnter:!1},modules:[l.pt],pagination:{clickable:!0},watchSlidesProgress:!0,onInit:e=>{w.current=e,$(e)},onSetTranslate:e=>$(e),onProgress:e=>$(e),onResize:e=>$(e),className:"categories-ribbon-swiper mt-2 lg:!px-3 !px-2",children:[r.jsx(i.o5,{className:"max-w-fit",children:r.jsx("div",{className:"px-3 py-2 text-xs font-semibold text-neutral-500 select-none",children:e("duration")})},"group-duration"),u.z3.map(e=>r.jsx(i.o5,{className:"max-w-fit",children:r.jsx(b,{label:e.label,displayLabel:a(`${e.id}.label`),icon:e.icon,queryKey:"duration",selected:y.includes(e.label)})},`duration-${e.label}`)),r.jsx(i.o5,{className:"max-w-fit",children:r.jsx("div",{className:"h-8 w-px bg-neutral-200 my-2 mx-2"})},"divider-1"),r.jsx(i.o5,{className:"max-w-fit",children:r.jsx("div",{className:"px-3 py-2 text-xs font-semibold text-neutral-500 select-none",children:e("purpose")})},"group-purpose"),u.KP.map(e=>r.jsx(i.o5,{className:"max-w-fit",children:r.jsx(b,{label:e.label,displayLabel:t(`${e.id}.label`),icon:e.icon,queryKey:"category",selected:p.includes(e.label)})},`purpose-${e.label}`)),r.jsx(i.o5,{className:"max-w-fit",children:r.jsx("div",{className:"h-8 w-px bg-neutral-200 my-2 mx-2"})},"divider-2"),r.jsx(i.o5,{className:"max-w-fit",children:r.jsx("div",{className:"px-3 py-2 text-xs font-semibold text-neutral-500 select-none",children:e("features")})},"group-features"),u.W$.map(e=>r.jsx(i.o5,{className:"max-w-fit",children:r.jsx(b,{label:e.label,displayLabel:s(`${e.id}.label`),icon:e.icon,queryKey:"feature",selected:x.includes(e.label)})},`feature-${e.label}`))]})})})}},60337:(e,a,t)=>{"use strict";t.d(a,{default:()=>j});var r=t(10326),d=t(17577),n=t(57305),i=t(35047),l=t(2114),s=t(6162),c=t(90434),o=t(15491),f=t(98655),b=t(50564),u=t(33265),h=t(74723),m=t(67001),g=t(94752),p=t(34643),y=t(97862),x=t(64798);let v=(0,u.default)(async()=>{},{loadableGenerated:{modules:["components/search/SearchPanel.tsx -> @/components/Calender"]},ssr:!1});function w({mode:e,onClose:a}){let t=(0,s.T)("SearchModal"),n=(0,p.bU)(),l=(0,i.useRouter)(),c=(0,i.useSearchParams)(),f=(0,d.useMemo)(()=>c?o.Z.parse(c.toString()):{},[c]),b=(0,d.useMemo)(()=>!!(f.startDate&&f.endDate),[f.endDate,f.startDate]),[u,w]=(0,d.useState)(b),{handleSubmit:j,setValue:N,watch:C,getValues:P}=(0,h.cI)({defaultValues:{location:null,wilayaCode:"",municipality:"",dateRange:{startDate:"string"==typeof f.startDate?new Date(f.startDate):new Date,endDate:"string"==typeof f.endDate?new Date(f.endDate):new Date,key:"selection"}}}),$=C("location"),I=C("wilayaCode"),A=C("municipality"),E=C("dateRange"),_=(e,a)=>{N(e,a,{shouldDirty:!0,shouldTouch:!0,shouldValidate:!0})},D="location"===e?!!P("location"):u;return(0,r.jsxs)("div",{className:"w-full rounded-2xl border border-neutral-200 bg-white shadow-xl overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-neutral-100",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[r.jsx("h4",{className:"text-[15px] font-semibold text-neutral-800 truncate",children:t("location"===e?"locationTitle":"dateTitle")}),r.jsx("p",{className:"text-[12px] text-neutral-500 truncate",children:t("location"===e?"locationSubtitle":"dateSubtitle")})]}),r.jsx("button",{type:"button",className:"p-1.5 rounded-full hover:bg-neutral-100 transition",onClick:a,"aria-label":"Close",children:r.jsx(g.QAE,{size:18})})]}),(0,r.jsxs)("form",{onSubmit:j(t=>{let{dateRange:r}=t,d={...f};delete d.guestCount,delete d.roomCount,delete d.bathroomCount,"location"===e&&(d.country=$?.label,d.region=$?.region,d.municipality=A||void 0,d.wilayaCode=I||void 0),"date"===e&&u&&(r?.startDate&&(d.startDate=(0,m.c)(r.startDate)),r?.endDate&&(d.endDate=(0,m.c)(r.endDate)));let n=o.Z.stringifyUrl({url:"/offers",query:d},{skipNull:!0});a(),l.push(n)}),children:[r.jsx("div",{className:"p-4",children:"date"===e?r.jsx("div",{className:"h-[348px] w-full",children:r.jsx(v,{onChange:(e,a)=>{w(!0),_(e,a)},value:E})}):r.jsx("div",{className:"flex flex-col gap-4",children:r.jsx(x.Z,{wilayaCode:I,municipality:A,onChange:_,language:"ar"===n?"ar":"fr"})})}),r.jsx("div",{className:"px-4 pb-4",children:r.jsx("div",{className:"flex items-center justify-end gap-2",children:r.jsx(y.Z,{type:"submit",disabled:!D,children:t("search")})})})]})]})}let j=()=>{let e=(0,s.T)("Search"),a=(0,i.useSearchParams)(),[t,u]=(0,d.useState)(null),h=null!==t,{ref:m}=(0,f.O)({action:()=>u(null),enable:h});(0,b.K)({key:"Escape",action:()=>u(null),enable:h});let g=a?.get("country"),p=a?.get("region"),y=a?.get("municipality"),x=a?.get("startDate"),v=a?.get("endDate"),j=(0,d.useMemo)(()=>{if(x&&v){let a=new Date(x),t=new Date(v),r=(0,n.j)(t,a);return 0===r&&(r=1),e("days",{count:r})}return e("anyWeek")},[v,x,e]),N=(0,d.useMemo)(()=>{let e=a?o.Z.parse(a.toString()):{};return delete e.guestCount,delete e.roomCount,delete e.bathroomCount,o.Z.stringifyUrl({url:"/offers",query:e},{skipNull:!0})},[a]);return(0,r.jsxs)("div",{ref:m,className:"relative",children:[r.jsx("div",{className:"border-[1px] w-full md:w-auto py-2 rounded-full shadow-sm hover:shadow-md transition duration-300 bg-white",children:(0,r.jsxs)("div",{className:"flex flex-row items-center w-full",children:[r.jsx("button",{type:"button",className:"flex-1 min-w-0 text-left px-4 sm:px-6 cursor-pointer",onClick:()=>u(e=>"location"===e?null:"location"),"aria-expanded":"location"===t,children:r.jsx("small",{className:"block text-sm font-bold text-[#585858] truncate",children:y||p||g||e("searchByLocation")})}),(0,r.jsxs)("button",{type:"button",className:"flex items-center gap-2 px-3 sm:px-6 border-l-[1px] border-neutral-200 cursor-pointer",onClick:()=>u(e=>"date"===e?null:"date"),"aria-expanded":"date"===t,children:[r.jsx(l.Pll,{className:"text-[14px] text-[#585858] sm:hidden"}),r.jsx("small",{className:"hidden sm:block text-sm font-bold text-[#585858] whitespace-nowrap",children:j})]}),r.jsx("div",{className:"pl-3 pr-2",children:r.jsx(c.default,{href:N,className:"p-2 bg-rose-500 rounded-full text-white inline-flex","aria-label":e("goToOffers"),onClick:()=>u(null),children:r.jsx(l.U41,{className:"text-[12px]"})})})]})}),t?r.jsx("div",{className:"absolute left-0 right-0 top-full mt-3 z-50",children:r.jsx(w,{mode:t,onClose:()=>u(null)})}):null]})}},36210:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(68570).createProxy)(String.raw`/home/oussasz/Project/Dz Dari/lugario/components/navbar/Categories.tsx#default`)},77808:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(68570).createProxy)(String.raw`/home/oussasz/Project/Dz Dari/lugario/components/navbar/Search.tsx#default`)},22818:(e,a,t)=>{"use strict";t.r(a),t.d(a,{$$ACTION_0:()=>o,$$ACTION_1:()=>b,$$ACTION_2:()=>h,$$ACTION_3:()=>g,$$ACTION_4:()=>y,createListing:()=>u,getListingById:()=>f,getListings:()=>c,getOwnedListingById:()=>m,updateListing:()=>p});var r=t(24330);t(60166);var d=t(9487),n=t(57708),i=t(67738),l=t(84848),s=t(40618);let c=(0,r.j)("bb5a5113cf8622f83e03f856ce80b496e8dd5e47",o);async function o(e){try{let{userId:a,roomCount:t,guestCount:r,bathroomCount:n,country:l,region:s,municipality:c,startDate:o,endDate:f,category:b,duration:u,feature:h,cursor:m}=e||{},g={};if(a&&(g.userId=a),b){let e=Array.isArray(b)?b:[b];g.category={in:e}}if(u){let e=Array.isArray(u)?u:[u];g.duration={in:e}}if(h){let e=Array.isArray(h)?h:[h];g.AND=[...g.AND??[],...e.map(e=>({features:{contains:e}}))]}t&&(g.roomCount={gte:+t}),r&&(g.guestCount={gte:+r}),n&&(g.bathroomCount={gte:+n}),l&&(g.country=l),s&&(g.region=s),c&&(g.municipality=c),o&&f&&(g.NOT={reservations:{some:{OR:[{endDate:{gte:o},startDate:{lte:o}},{startDate:{lte:f},endDate:{gte:f}}]}}});let p={where:g,take:i.UM,orderBy:{createdAt:"desc"}};m&&(p.cursor={id:m},p.skip=1);let y=await d.db.listing.findMany(p),x=y.length===i.UM?y[i.UM-1].id:null;return{listings:y,nextCursor:x}}catch(e){return{listings:[],nextCursor:null}}}let f=(0,r.j)("bd12bcafed4fce27c9e0d8b6a1be9463e7e7f752",b);async function b(e){return await d.db.listing.findUnique({where:{id:e},include:{user:{select:{name:!0,image:!0}},reservations:{select:{startDate:!0,endDate:!0}}}})}let u=(0,r.j)("067060037a75f005439918d9fa246b510679bcf1",h);async function h(e){let{category:a,duration:t,features:r,location:{region:n,label:i,latlng:s},municipality:c,address:o,guestCount:f,bathroomCount:b,roomCount:u,image:h,images:m,price:g,title:p,description:y}=e;for(let a of["category","duration","location","municipality","address","guestCount","roomCount","bathroomCount","price","title","description"])if(!e[a])throw Error(`Missing required field: ${a}`);let x=Array.isArray(m)?m:"string"==typeof h&&h?[h]:[];if(!x.length)throw Error("At least one image is required");if(x.length>5)throw Error("Maximum 5 images allowed");let v=x[0],w=await (0,l.t)();if(!w)throw Error("Unauthorized!");return await d.db.listing.create({data:{title:p,description:y,imageSrc:v,images:JSON.stringify(x),category:a,duration:t,features:Array.isArray(r)?r.join(","):r||"",roomCount:u,bathroomCount:b,guestCount:f,country:i,region:n,municipality:c,address:o,latitude:s[0],longitude:s[1],price:parseInt(g,10),userId:w.id}})}let m=(0,r.j)("c16e9b0ffa6a408dad2f5997cf326ae06b44b4d1",g);async function g(e){if(!e||"string"!=typeof e)throw Error("Invalid ID");let a=await (0,l.t)();if(!a)throw Error("Unauthorized!");let t=await d.db.listing.findUnique({where:{id:e,userId:a.id}});if(!t)throw Error("Listing not found!");return t}let p=(0,r.j)("d36b29d06e37f5131001fbebc6e7a104ae8d2507",y);async function y(e,a){if(!e||"string"!=typeof e)throw Error("Invalid ID");let t=await (0,l.t)();if(!t)throw Error("Unauthorized!");let{category:r,duration:i,features:s,location:c,municipality:o,address:f,guestCount:b,bathroomCount:u,roomCount:h,image:m,images:g,price:p,title:y,description:x}=a;for(let e of["category","duration","location","municipality","address","guestCount","roomCount","bathroomCount","price","title","description"])if(!a[e])throw Error(`Missing required field: ${e}`);let v=Array.isArray(g)?g:"string"==typeof m&&m?[m]:[];if(!v.length)throw Error("At least one image is required");if(v.length>5)throw Error("Maximum 5 images allowed");let w=v[0],j=c?.region,N=c?.label,C=c?.latlng;if(!j||!N||!Array.isArray(C)||C.length<2)throw Error("Invalid location");if(!(await d.db.listing.updateMany({where:{id:e,userId:t.id},data:{title:y,description:x,imageSrc:w,images:JSON.stringify(v),category:r,duration:i,features:Array.isArray(s)?s.join(","):s||"",roomCount:h,bathroomCount:u,guestCount:b,country:N,region:j,municipality:o,address:f,latitude:C[0],longitude:C[1],price:parseInt(p,10)}})).count)throw Error("Listing not found!");return(0,n.revalidatePath)("/"),(0,n.revalidatePath)("/properties"),(0,n.revalidatePath)("/favorites"),(0,n.revalidatePath)(`/listings/${e}`),{id:e}}(0,s.h)([c,f,u,m,p]),(0,r.j)("a44eac80d9a1a0040b970ea25de7a8d85fcc50a4",c),(0,r.j)("58ed5bbaa85d255292baf8aba25c4a07c7e80a40",f),(0,r.j)("0aa2753f4c5c9e267bdfe41bb6dfd75e8d2cbff6",u),(0,r.j)("64fd960cfd7af4d30707bdefd94da62903576a93",m),(0,r.j)("f71d8aca32bb00c035910ca7953e75596f736162",p)},8392:(e,a,t)=>{"use strict";t.r(a),t.d(a,{$$ACTION_0:()=>o,$$ACTION_1:()=>b,deleteProperty:()=>f,getProperties:()=>c});var r=t(27745);t(26461);var d=t(88296),n=t(33408),i=t(10692),l=t(30207),s=t(85723);let c=(0,r.j)("b676ec8e1485e7c1a29ec33d480771117f6799e4",o);async function o(e){try{let{userId:a,cursor:t}=e||{};if(!a)throw Error("Unauthorized");let r={where:{userId:a},take:n.UM,orderBy:{createdAt:"desc"}};t&&(r.cursor={id:t},r.skip=1);let i=await d.db.listing.findMany({...r}),l=i.length===n.UM?i[n.UM-1].id:null;return{listings:i,nextCursor:l}}catch(e){return{listings:[],nextCursor:null}}}let f=(0,r.j)("0b0257361201c67ca7edfd2944301935df9b21f2",b);async function b(e){try{let a=await (0,i.t)();if(!a)throw Error("Unauthorized");if(!e||"string"!=typeof e)throw Error("Invalid ID");return await d.db.listing.deleteMany({where:{id:e,userId:a.id}}),(0,l.revalidatePath)("/"),(0,l.revalidatePath)("/reservation"),(0,l.revalidatePath)("/trips"),(0,l.revalidatePath)("/favorites"),(0,l.revalidatePath)("/properties"),(0,l.revalidatePath)(`/listings/${e}`),"success"}catch(e){throw Error("Failed to delete the property!")}}(0,s.h)([c,f]),(0,r.j)("cac5bff2370d361859fcb45ded3a18f9feb290ff",c),(0,r.j)("db16f98a7dd509dc43fd9fb70035dab959baf639",f)},51047:(e,a,t)=>{"use strict";t.r(a),t.d(a,{$$ACTION_0:()=>u,$$ACTION_1:()=>m,$$ACTION_2:()=>p,$$ACTION_3:()=>x,createPaymentSession:()=>y,createReservation:()=>h,deleteReservation:()=>g,getReservations:()=>b});var r=t(27745);t(26461);var d=t(30207),n=t(88296),i=t(33408),l=t(10692),s=t(364);let c=process.env.STRIPE_API_KEY,o=c?new s.Z(c,{apiVersion:"2024-09-30.acacia",typescript:!0}):null;var f=t(85723);let b=(0,r.j)("31b04723e7c53cd1acbec67b730e7d0abc16a5f7",u);async function u(e){try{let{listingId:a,userId:t,authorId:r,cursor:d}=e,l={};t&&(l.userId=t),a&&(l.listingId=a),r&&(l.listing={userId:r});let s={where:l,take:i.UM,include:{listing:!0},orderBy:{createdAt:"desc"}};d&&(s.cursor={id:d},s.skip=1);let c=await n.db.reservation.findMany({...s}),o=c.length===i.UM?c[i.UM-1].id:null;return{listings:c.map(e=>{let{id:a,startDate:t,endDate:r,totalPrice:d,listing:n}=e;return{...n,reservation:{id:a,startDate:t,endDate:r,totalPrice:d}}}),nextCursor:o}}catch(e){return console.log(e?.message),{listings:[],nextCursor:null}}}let h=(0,r.j)("33f115557067f48ceee4a50b443aa423758b731d",m);async function m({listingId:e,startDate:a,endDate:t,totalPrice:r,userId:i}){try{if(!e||!a||!t||!r)throw Error("Invalid data");await n.db.listing.update({where:{id:e},data:{reservations:{create:{userId:i,startDate:a,endDate:t,totalPrice:r}}}}),(0,d.revalidatePath)(`/listings/${e}`)}catch(e){throw Error(e?.message)}}let g=(0,r.j)("3e9103be237aebf085f90f3c7858dad7d4c215ad",p);async function p(e){try{let a=await (0,l.t)();if(!a)throw Error("Unauthorized");if(!e||"string"!=typeof e)throw Error("Invalid ID");let t=await n.db.reservation.findUnique({where:{id:e}});if(!t)throw Error("Reservation not found!");return await n.db.reservation.deleteMany({where:{id:e,OR:[{userId:a.id},{listing:{userId:a.id}}]}}),(0,d.revalidatePath)("/reservations"),(0,d.revalidatePath)(`/listings/${t.listingId}`),(0,d.revalidatePath)("/trips"),t}catch(e){throw Error(e.message)}}let y=(0,r.j)("0ad09d62211ecf130a12e0b1fb6dd072ad373b1e",x);async function x({listingId:e,startDate:a,endDate:t,totalPrice:r}){if(!e||!a||!t||!r)throw Error("Invalid data");let d=await n.db.listing.findUnique({where:{id:e}});if(!d)throw Error("Listing not found!");let i=await (0,l.t)();if(!i)throw Error("Please log in to reserve!");let s=await o.products.create({name:"Listing",images:[d.imageSrc],default_price_data:{currency:"USD",unit_amount:100*r}});return{url:(await o.checkout.sessions.create({success_url:`${process.env.NEXT_PUBLIC_SERVER_URL}/trips`,cancel_url:`${process.env.NEXT_PUBLIC_SERVER_URL}/listings/${d.id}`,payment_method_types:["card"],mode:"payment",shipping_address_collection:{allowed_countries:["DE","US","NP","CH","BH","AU"]},metadata:{listingId:e,startDate:String(a),endDate:String(t),totalPrice:r,userId:i.id},line_items:[{price:s.default_price,quantity:1}]})).url}}(0,f.h)([b,h,g,y]),(0,r.j)("1106a624fc89780734d43596a1878891b0872f57",b),(0,r.j)("84b639be183e082fba4d06c9dff2f39883927b92",h),(0,r.j)("2ad9c02f7138be20aaff203fa989dbdd2c65d88f",g),(0,r.j)("578785c17f7947cb2d65472cb4242c57c8621203",y)},67738:(e,a,t)=>{"use strict";t.d(a,{UM:()=>n});var r=t(63759),d=t(43758);r.Paj,r.f$3,r.sHf,r.sHf,r.dKE,r.dKE,r.Yfi,r.KfF,r.Nzl,r.eAf,r.Yqy,r.jsv,r.I4E,r.rhR,r.vc9,d.Q7H,r.Ys1,r.IB_,r.bVG,r.yEz,r.XG1,r.eVG,r.WKE,r.h9I,r.fC4;let n=16}};