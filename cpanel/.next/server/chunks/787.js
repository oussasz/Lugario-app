"use strict";exports.id=787,exports.ids=[787],exports.modules={8825:(e,t,a)=>{a.d(t,{default:()=>n});var r=a(10326);a(17577);var s=a(89254),i=a(90434),l=a(6162);let n=({title:e,subtitle:t,showReset:a})=>{let n=(0,l.T)("Empty"),d=e??n("noExactMatches"),o=t??n("tryChangeFilters");return(0,r.jsxs)("div",{className:" h-[60vh] flex flex-col gap-2 justify-center items-center",children:[r.jsx(s.Z,{center:!0,title:d,subtitle:o}),r.jsx("div",{className:"w-48 mt-4",children:a&&r.jsx(i.default,{href:"/",className:"bg-white border-[1px] border-gray-500 text-[#4e4e4e] rounded hover:opacity-80 transition ",children:n("removeAllFilters")})})]})}},82005:(e,t,a)=>{a.d(t,{default:()=>p});var r=a(10326),s=a(17577),i=a(67765),l=a(40381),n=a(45204),d=a(97964),o=a.n(d),c=a(77109),u=a(52117);a(15424);var f=a(46242);(0,f.$)("001837c49f82a4a4d75b3dc0964dc6c76e2d2b77"),(0,f.$)("c1a53f0f37ee773167b45a3bf6a61b76eb07c326");var x=(0,f.$)("ab224d6a6aaea9fdd9ddb9b9a8c9dad0cd2e02f8");let p=({listingId:e,hasFavorited:t})=>{let{status:a}=(0,c.useSession)(),[d,f]=(0,s.useState)(t),p=(0,s.useRef)(t),{mutate:m}=(0,n.D)({mutationFn:x,onError:()=>{p.current=!p.current,f(p.current),l.Am.error("Failed to favorite")}}),h=o()(()=>{m({listingId:e,favorite:p.current})},300),g=(0,s.useCallback)(()=>{h()},[]);return(0,r.jsxs)("button",{type:"button",onClick:e=>{if(e.stopPropagation(),e.preventDefault(),"authenticated"!==a){l.Am.error("Please sign in to favorite the listing!");return}g(),f(e=>!e),p.current=!p.current},className:" relative hover:opacity-80 transition cursor-pointer z-[5] ",children:[r.jsx(i.lo,{size:28,className:"   text-gray-50   absolute   -top-[2px]   -right-[2px]   "}),r.jsx(i.M_L,{size:24,className:(0,u.cn)(d?"fill-rose-500":"fill-neutral-500/70")})]})}},10307:(e,t,a)=>{a.d(t,{default:()=>n});var r=a(10326),s=a(17577),i=a(46226),l=a(52117);let n=({imageSrc:e,fill:t=!1,alt:a,className:n,priority:d=!1,effect:o,sizes:c})=>{let[u,f]=(0,s.useState)(!1);return r.jsx(i.default,{fill:t,className:(0,l.cn)("transition duration-300","zoom"===o&&"scale-95",u?"opacity-100 scale-100":"opacity-0",n),src:e,alt:a,onLoad:()=>f(!0),priority:d,sizes:c,unoptimized:!0})}},54655:(e,t,a)=>{a.d(t,{T:()=>_,default:()=>W});var r=a(10326),s=a(17577),i=a(90434),l=a(3474),n=a(3778),d=a(34643),o=a(6162),c=a(82005),u=a(10307),f=a(52117),x=a(66373),p=a(35047),m=a(45204),h=a(40381),g=a(90329),b=a(60132),v=a(94752),j=a(97862),y=a(13192);let w=({title:e,onConfirm:t,onCloseModal:a,isLoading:s=!1})=>(0,r.jsxs)("div",{className:" flex flex-col gap-3 px-6 py-8 relative",children:[r.jsx("button",{type:"button",className:" p-1 border-0  hover:opacity-70 transition absolute right-3 top-3",onClick:()=>a?.(),children:r.jsx(v.QAE,{size:20})}),r.jsx("h1",{className:"text-[22px] font-bold text-gray-800",children:e}),r.jsx("p",{className:"text-gray-700  text-[16px] leading-[1.6] mb-4",children:"Are you sure you want to do this? It can't be undone."}),(0,r.jsxs)("div",{className:"flex items-center gap-3 mt-1 h-[40px]",children:[r.jsx(j.Z,{onClick:()=>a?.(),className:"h-full",outline:!0,children:"Cancel"}),r.jsx(j.Z,{onClick:()=>{t(a)},className:"h-full flex items-center justify-center",children:s?r.jsx(y.Z,{}):r.jsx("span",{children:" Confirm"})})]})]});var N=a(92441),C=a(51327),Z=a(2209);let I={value:"DZ",label:"Algeria",flag:"\uD83C\uDDE9\uD83C\uDDFF"},E=e=>e?e.split(",").map(e=>e.trim()).filter(Boolean):[],D=e=>{if(!e)return"";let t=Z.find(t=>t?.nameFr===e||t?.nameAr===e);return t?.code??""},P=({listingId:e,onCloseModal:t})=>{let[a,i]=(0,s.useTransition)(),[l,n]=(0,s.useState)(null);(0,s.useEffect)(()=>{i(async()=>{try{let t=await (0,C.Cy)(e),a=D(t.region),r=t.latitude,s=t.longitude,i="number"==typeof r&&"number"==typeof s;n({duration:t.duration??"",category:t.category??"",features:E(t.features),location:i&&t.region?{...I,label:t.country??I.label,region:t.region,latlng:[r,s]}:null,wilayaCode:a,municipality:t.municipality??"",address:t.address??"",guestCount:t.guestCount??1,bathroomCount:t.bathroomCount??1,roomCount:t.roomCount??1,image:t.imageSrc??"",price:null!=t.price?String(t.price):"",title:t.title??"",description:t.description??""})}catch(e){h.ZP.error(e?.message||"Failed to load listing"),t?.()}})},[e,t]);let d=(0,s.useMemo)(()=>(0,r.jsxs)("div",{className:"w-full h-full flex flex-col",children:[r.jsx(b.Z.WindowHeader,{title:"Edit property"}),r.jsx("div",{className:"p-6 flex items-center justify-center",children:r.jsx(y.Z,{})})]}),[]);return l?r.jsx(N.Z,{mode:"edit",listingId:e,initialValues:l,onCloseModal:t}):d};a(15424);var z=a(46242),S=(0,z.$)("db16f98a7dd509dc43fd9fb70035dab959baf639");(0,z.$)("cac5bff2370d361859fcb45ded3a18f9feb290ff"),(0,z.$)("578785c17f7947cb2d65472cb4242c57c8621203"),(0,z.$)("1106a624fc89780734d43596a1878891b0872f57"),(0,z.$)("84b639be183e082fba4d06c9dff2f39883927b92");var $=(0,z.$)("2ad9c02f7138be20aaff203fa989dbdd2c65d88f");let T={"/properties":"Delete property","/trips":"Cancel reservation","/reservations":"Cancel guest reservation"},F=e=>e?"/"===e?"/":e.replace(/\/+$/,""):"",L=({id:e})=>{let t=F((0,p.usePathname)()),a=t.endsWith("/favorites"),i=t.endsWith("/properties"),l=t.endsWith("/trips"),n=t.endsWith("/reservations"),d=i?T["/properties"]:l?T["/trips"]:n?T["/reservations"]:"",{mutate:o}=(0,m.D)({mutationFn:S}),{mutate:c}=(0,m.D)({mutationFn:$}),[u,f]=(0,s.useTransition)();return"/"!==t&&!a&&(i||l||n)?(0,r.jsxs)(b.Z,{children:[(0,r.jsxs)(g.Z,{children:[r.jsx(g.Z.Toggle,{id:"lisiting-menu",className:"w-10 h-10 flex items-center z-5 justify-center",children:r.jsx("button",{type:"button",className:"w-7 h-7 rounded-full bg-neutral-700/50 flex items-center justify-center hover:bg-neutral-700/70 group transition duration-200 z-[5]",children:r.jsx(x.evw,{className:"h-[18px] w-[18px] text-gray-300 transition duration-100 group-hover:text-gray-100 "})})}),(0,r.jsxs)(g.Z.List,{position:"bottom-left",className:"rounded-md",children:[i?r.jsx(b.Z.Trigger,{name:"edit-listing",children:r.jsx(g.Z.Button,{className:"text-[14px] rounded-md font-semibold py-[10px] hover:bg-neutral-100 transition",children:"Edit property"})}):null,r.jsx(b.Z.Trigger,{name:"confirm-delete",children:r.jsx(g.Z.Button,{className:"text-[14px] rounded-md font-semibold py-[10px] hover:bg-neutral-100 transition",children:d})})]})]}),i?r.jsx(b.Z.Window,{name:"edit-listing",children:r.jsx(P,{listingId:e})}):null,r.jsx(b.Z.Window,{name:"confirm-delete",children:r.jsx(w,{onConfirm:t=>{f(()=>{try{i?o(e,{onSuccess:()=>{t?.(),h.ZP.success("Listing successfully deleted!")}}):(l||n)&&c(e,{onSuccess:()=>{t?.(),h.ZP.success("Reservation successfully cancelled!")}})}catch(e){h.ZP.error("Oops! Something went wrong. Please try again later."),t?.()}})},title:d,isLoading:u})})]}):null};var A=a(63347);let W=({data:e,reservation:t,hasFavorited:a})=>{let s;let n=(0,d.bU)(),x=(0,o.T)("Listing"),p=(0,o.T)("PurposeOptions"),m=t?t.totalPrice:e?.price;if(t){let e=new Date(t.startDate),a=new Date(t.endDate);s=`${(0,l.WU)(e,"PP")} - ${(0,l.WU)(a,"PP")}`}let h=(()=>{let t=A.KP.find(t=>t.label===e.category);return t?p(`${t.id}.label`):e.category})();return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("div",{className:"absolute top-0 left-0 p-3 flex items-center justify-between w-full",children:[r.jsx("div",{className:"z-5",children:r.jsx(L,{id:t?.id||e.id})}),r.jsx("div",{className:"w-[28px] h-[28px] flex items-center justify-center",children:r.jsx(c.default,{listingId:e.id,hasFavorited:a},e.id)})]}),r.jsx(i.default,{href:`/listings/${e.id}`,className:"col-span-1 cursor-pointer",children:(0,r.jsxs)("div",{className:"flex flex-col gap-1 w-full",children:[r.jsx("div",{className:" overflow-hidden md:rounded-xl rounded-md",children:r.jsx("div",{className:"aspect-[1/0.95] relative bg-gray-100",children:r.jsx(u.default,{imageSrc:e.imageSrc,fill:!0,alt:e.title,effect:"zoom",className:"object-cover",sizes:"100vw"})})}),(0,r.jsxs)("span",{className:"font-semibold text-[16px] mt-[4px]",children:[e?.region,", ",e?.country]}),r.jsx("span",{className:"font-light text-neutral-500 text-sm",children:s||h}),(0,r.jsxs)("div",{className:"flex flex-row items-baseline gap-1",children:[(0,r.jsxs)("span",{className:"font-bold text-[#444] text-[14px]",children:["DZD ",(0,f.T)(m,n)]}),!t&&r.jsx("span",{className:"font-light",children:(()=>{switch(e.duration){case"byNight":default:return x("night");case"perWeek":return x("week");case"perMonth":return x("month");case"longTerm":return x("longTerm")}})()})]})]})})]})},_=()=>r.jsx("div",{className:"col-span-1 ",children:(0,r.jsxs)("div",{className:"flex flex-col gap-1 w-full",children:[r.jsx(n.Z,{width:"100%",height:"100%",borderRadius:"12px",className:"aspect-square"}),(0,r.jsxs)("div",{className:"flex flex-row gap-3",children:[r.jsx(n.Z,{height:"18px",width:"84px"}),r.jsx(n.Z,{height:"18px",width:"84px"})]}),r.jsx(n.Z,{height:"16px",width:"102px"}),r.jsx(n.Z,{height:"18px",width:"132px"})]})})},71539:(e,t,a)=>{a.d(t,{Z:()=>r});let r=(0,a(68570).createProxy)(String.raw`/home/oussasz/Project/Dz Dari/lugario/components/EmptyState.tsx#default`)},79687:(e,t,a)=>{a.d(t,{Z:()=>s});var r=a(68570);let s=(0,r.createProxy)(String.raw`/home/oussasz/Project/Dz Dari/lugario/components/ListingCard.tsx#default`);(0,r.createProxy)(String.raw`/home/oussasz/Project/Dz Dari/lugario/components/ListingCard.tsx#ListingSkeleton`)},41183:(e,t,a)=>{a.r(t),a.d(t,{$$ACTION_0:()=>o,$$ACTION_1:()=>u,$$ACTION_2:()=>x,getFavoriteListings:()=>f,getFavorites:()=>d,updateFavorite:()=>c});var r=a(24330);a(60166);var s=a(9487),i=a(84848),l=a(57708),n=a(40618);let d=(0,r.j)("573aee30d49bf9c1a8aea2c43b09b3a41110c6c2",o);async function o(){try{let e=await (0,i.t)();if(!e)return[];return(await s.db.favorite.findMany({where:{userId:e.id},select:{listingId:!0}})).map(e=>e.listingId)}catch(e){return[]}}let c=(0,r.j)("476c2e271afa7809c316ac65717a0cf700a3d3d8",u);async function u({listingId:e,favorite:t}){try{let a;if(!e||"string"!=typeof e)throw Error("Invalid ID");let r=await (0,i.t)();if(!r)throw Error("Please sign in to favorite the listing!");return t?(await s.db.favorite.upsert({where:{userId_listingId:{userId:r.id,listingId:e}},create:{userId:r.id,listingId:e},update:{}}),a=!0):(await s.db.favorite.deleteMany({where:{userId:r.id,listingId:e}}),a=!1),(0,l.revalidatePath)("/"),(0,l.revalidatePath)(`/listings/${e}`),(0,l.revalidatePath)("/favorites"),{hasFavorited:a}}catch(e){throw Error(e.message)}}let f=(0,r.j)("db2f0e26ed6c20fadfc94ebc5160fc769b450ad9",x);async function x(){try{let e=await (0,i.t)();if(!e)return[];return await s.db.listing.findMany({where:{favoritedBy:{some:{userId:e.id}}}})}catch(e){throw Error(e.message)}}(0,n.h)([d,c,f]),(0,r.j)("c1a53f0f37ee773167b45a3bf6a61b76eb07c326",d),(0,r.j)("ab224d6a6aaea9fdd9ddb9b9a8c9dad0cd2e02f8",c),(0,r.j)("001837c49f82a4a4d75b3dc0964dc6c76e2d2b77",f)},10692:(e,t,a)=>{a.d(t,{t:()=>u});var r=a(43153),s=a(67096),i=a.n(s),l=a(12458),n=a(34413),d=a(85876),o=a(88296);let c={adapter:(0,l.N)(o.db),providers:[(0,d.Z)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET}),(0,n.Z)({name:"credentials",credentials:{email:{label:"email",type:"text"},password:{label:"password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)throw Error("Invalid credentials");let t=await o.db.user.findUnique({where:{email:e.email}});if(!t||!t?.password||!await i().compare(e.password,t.password))throw Error("Invalid credentials");return t}})],callbacks:{session:async({token:e,session:t})=>(e&&(t.user.id=e.id,t.user.name=e.name,t.user.email=e.email),t),jwt:async({token:e,user:t})=>t?{...e,...t}:e},pages:{signIn:"/"},session:{strategy:"jwt"},secret:process.env.NEXTAUTH_SECRET},u=async()=>{let e=await (0,r.getServerSession)(c);return e?.user}},33408:(e,t,a)=>{a.d(t,{UM:()=>i});var r=a(73997),s=a(58544);r.Paj,r.f$3,r.sHf,r.dKE,r.Yfi,r.KfF,r.Nzl,r.eAf,r.Yqy,r.jsv,r.I4E,r.rhR,r.vc9,s.Q7H,r.Ys1,r.IB_,r.bVG,r.yEz,r.XG1,r.eVG,r.WKE,r.h9I,r.fC4;let i=16},57481:(e,t,a)=>{a.r(t),a.d(t,{default:()=>s});var r=a(66621);let s=e=>[{type:"image/x-icon",sizes:"256x256",url:(0,r.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};